import{a as Pe,b as De,c as Oe}from"./chunk-RFHNYTRN.js";import{a as A,b as L,c as Ne}from"./chunk-PKP3HEYI.js";import{l as W,m as ke,n as se,o as Ve}from"./chunk-F45RQ6PG.js";import"./chunk-HPHDTXNO.js";import"./chunk-PTD2UHZP.js";import{a as Q}from"./chunk-3USFH6CF.js";import{$c as D,Aa as e,Ba as c,Ca as re,Da as le,F as ie,Fa as C,Ha as _,Hb as B,J as b,Ja as p,Jb as K,K as ne,Lb as _e,O as h,Oa as xe,P as v,Pa as s,Q as U,Qa as x,R as Z,Ra as S,Sa as pe,Sc as E,Tc as z,Ua as he,Vc as J,Xa as w,Ya as q,Yc as k,Zc as V,_c as P,aa as ge,ab as ve,ad as O,bd as N,cb as Ce,cd as R,dd as be,ea as o,ed as Ee,fa as y,fd as ze,gd as we,ia as H,id as Me,kd as F,ld as Te,md as Ie,n as te,na as d,qa as fe,qb as I,ra as ce,rb as M,ua as g,va as T,xa as ae,ya as oe,yb as Se,za as i,zb as ye}from"./chunk-XRNJ2UIA.js";function Ke(t,r){t&1&&(i(0,"app-load"),s(1,"Cargando ..."),e())}function Je(t,r){if(t&1&&(i(0,"span",21),s(1),e()),t&2){let n=p();o(),x(n.errors.km)}}function Qe(t,r){if(t&1&&(i(0,"span",21),s(1),e()),t&2){let n=p();o(),x(n.errors.entry_date)}}function We(t,r){if(t&1&&c(0,"nz-option",22),t&2){let n=r.$implicit;d("nzLabel",n.plate+" - "+n.example.name+" - "+n.color.name+" - "+n.year.name+" / "+n.client.document+" - "+n.client.name+" "+n.client.surname+" "+n.client.last_name)("nzValue",n.id)}}function Xe(t,r){if(t&1&&(i(0,"span",21),s(1),e()),t&2){let n=p();o(),x(n.errors.car_id)}}function Ye(t,r){if(t&1&&c(0,"nz-option",23),t&2){let n=r.$implicit;d("nzLabel",n.document+" - "+n.name+" "+n.surname+" "+n.last_name)("nzValue",n.id)}}function Ze(t,r){if(t&1&&(i(0,"span",21),s(1),e()),t&2){let n=p();o(),x(n.errors.client_id)}}var Fe=(()=>{let r=class r{constructor(a){this.service=a,this.loading=!1,this.item={},this.data=[],this.errors=null}ngOnInit(){this.getData()}getData(){this.loading=!0;let a=this.service.api("mec/getClients","post",{company_id:this.service.user.company_id,per_page:"all"}),m=this.service.api("mec/getCars?included=client,brand,color,year,example","post",{company_id:this.service.user.company_id,per_page:"all"}),l=te(a,m),f=[];l.subscribe(u=>{f.push(u.data)},u=>{console.log(u)},()=>{this.data.clients=f[0],this.data.cars=f[1],this.loading=!1})}save(){this.loading=!0,this.errors=null,this.item.company_id=this.service.user.company_id,this.service.api("sale/registerSale","post",this.item).subscribe(a=>{this.loading=!1,this.service.toast("success","Venta Registrada"),this.service.goPage("sale/edit/"+a.data.id)},a=>{console.log(a),this.loading=!1,this.errors=a.error.errors,this.service.toast("error","Registro fallido")})}};r.\u0275fac=function(m){return new(m||r)(y(E))},r.\u0275cmp=b({type:r,selectors:[["app-sale-create"]],decls:41,vars:11,consts:[[1,"overflow-x-scroll"],[1,"px-2","py-3"],[1,"grid","gap-2","mb-6","md:grid-cols-2"],[1,"label-form"],[1,"fa-brands","fa-medapps","text-red-600","font-bold"],[1,"relative"],[1,"input-icon"],[1,"fa-solid","fa-id-card-clip","text-gray-500"],["name","km","type","text","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["class","error",4,"ngIf"],[1,"fa-solid","fa-signature","text-gray-500"],["name","entry_date","type","date","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["name","item.car_id","nzShowSearch","","nzAllowClear","","nzPlaceHolder","Selecciona un Veh\xEDculo",1,"w-full","p-1","bg-gray-200","rounded-lg","border-gray-300","border",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["name","item.client_id","nzShowSearch","","nzAllowClear","","nzPlaceHolder","Selecciona un Conductor",1,"w-full","p-1","bg-gray-200","rounded-lg","border-gray-300","border",3,"ngModel","ngModelChange"],["nzValue","jack",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],[1,"flex"],[1,"btn-save",3,"click"],[1,"fa-solid","fa-floppy-disk"],[1,"btn-list",3,"click"],[1,"fa-solid","fa-table"],[1,"error"],[3,"nzLabel","nzValue"],["nzValue","jack",3,"nzLabel","nzValue"]],template:function(m,l){m&1&&(g(0,Ke,2,0,"app-load"),i(1,"app-title"),s(2,"Registrar Venta"),e(),i(3,"form",0)(4,"div",1)(5,"div",2)(6,"div")(7,"label",3),s(8,"KM "),c(9,"i",4),e(),i(10,"div",5)(11,"div",6),c(12,"i",7),e(),i(13,"input",8),_("ngModelChange",function(u){return l.item.km=u}),e()(),g(14,Je,2,1,"span",9),e(),i(15,"div")(16,"label",3),s(17,"Fecha Ingreso"),e(),i(18,"div",5)(19,"div",6),c(20,"i",10),e(),i(21,"input",11),_("ngModelChange",function(u){return l.item.entry_date=u}),e()(),g(22,Qe,2,1,"span",9),e(),i(23,"div")(24,"label",3),s(25,"Veh\xEDculo"),e(),i(26,"nz-select",12),_("ngModelChange",function(u){return l.item.car_id=u}),g(27,We,1,2,"nz-option",13),e(),g(28,Xe,2,1,"span",9),e(),i(29,"div")(30,"label",3),s(31,"Conductor "),c(32,"i",4),e(),i(33,"nz-select",14),_("ngModelChange",function(u){return l.item.client_id=u}),g(34,Ye,1,2,"nz-option",15),e(),g(35,Ze,2,1,"span",9),e()(),i(36,"div",16)(37,"button",17),_("click",function(){return l.save()}),c(38,"i",18),e(),i(39,"a",19),_("click",function(){return l.service.goPage("sale/index")}),c(40,"i",20),e()()()()),m&2&&(T(0,l.loading?0:-1),o(13),d("ngModel",l.item.km),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.entry_date),o(),d("ngIf",l.errors),o(4),d("ngModel",l.item.car_id),o(),d("ngForOf",l.data.cars),o(),d("ngIf",l.errors),o(5),d("ngModel",l.item.client_id),o(),d("ngForOf",l.data.clients),o(),d("ngIf",l.errors))},dependencies:[I,M,F,z,N,k,V,P,O,D,A,L]});let t=r;return t})();var et=(t,r)=>r.id;function tt(t,r){t&1&&c(0,"app-load")}function it(t,r){if(t&1){let n=C();i(0,"a",8),_("click",function(){h(n);let m=p();return v(m.service.goPage("sale/create"))}),c(1,"i",9),e()}}function nt(t,r){t&1&&(i(0,"span",23),s(1," DEUDA "),e())}function at(t,r){t&1&&(i(0,"span",24),s(1," PENDIENTE "),e())}function ot(t,r){t&1&&(i(0,"span",25),s(1," CANCELADO "),e())}function rt(t,r){t&1&&(i(0,"span",26),s(1," PAGADO "),e())}function lt(t,r){if(t&1){let n=C();i(0,"a",27),_("click",function(){h(n);let m=p().$implicit,l=p();return v(l.service.goPage("sale/message/"+m.id))}),c(1,"i",28),e()}}var st=t=>["/report-sale",t];function mt(t,r){if(t&1&&(i(0,"a",29),c(1,"i",30),e()),t&2){let n=p().$implicit;d("routerLink",q(1,st,n.id))}}function dt(t,r){if(t&1){let n=C();i(0,"a",31),_("click",function(){h(n);let m=p().$implicit,l=p();return v(l.service.goPage("sale/detail/"+m.id))}),c(1,"i",32),e()}}function ct(t,r){if(t&1){let n=C();i(0,"a",27),_("click",function(){h(n);let m=p().$implicit,l=p();return v(l.service.goPage("sale/edit/"+m.id))}),c(1,"i",33),e()}}var pt=()=>["sale.message"],_t=()=>["sale.print"],ut=()=>["sale.detail"],gt=()=>["sale.edit"];function ft(t,r){if(t&1&&(i(0,"tr",10)(1,"td",11),s(2),e(),i(3,"td",11),g(4,nt,2,0,"span",12)(5,at,2,0,"span",13)(6,ot,2,0,"span",14)(7,rt,2,0,"span",15),e(),i(8,"td",16),s(9),ve(10,"date"),e(),i(11,"td",17),s(12),e(),i(13,"td",11),c(14,"i",18)(15,"br"),i(16,"div"),s(17),c(18,"br"),s(19),c(20,"br"),e()(),i(21,"td",19),g(22,lt,2,0,"a",20)(23,mt,2,3,"a",21)(24,dt,2,0,"a",22)(25,ct,2,0,"a",20),e()()),t&2){let n=r.$implicit;o(2),S("N\xB0 ",n.number,""),o(2),d("ngIf",n.status=="debt"),o(),d("ngIf",n.status=="pending"),o(),d("ngIf",n.status=="cancelled"),o(),d("ngIf",n.status=="done"),o(2),S(" ",Ce(10,20,n.payment_date,"dd/MM/yyyy")," "),o(3),he(" ",n.car.client.document," - ",n.car.client.name," ",n.car.client.surname," ",n.car.client.last_name," "),o(2),fe("color:"+n.car.color.hex),o(3),pe(" ",n.car.plate," - ",n.car.example.name," "),o(2),pe(" ",n.car.brand.name," - ",n.car.year.name," "),o(3),d("setPermission",w(23,pt)),o(),d("setPermission",w(24,_t)),o(),d("setPermission",w(25,ut)),o(),d("setPermission",w(26,gt))}}function xt(t,r){if(t&1){let n=C();i(0,"nav",7)(1,"ul",34)(2,"li")(3,"a",35),_("click",function(){h(n);let m=p();return v(m.changePage(-1))}),U(),i(4,"svg",36),c(5,"path",37),e(),Z(),i(6,"span"),s(7,"Anterior"),e()()(),i(8,"li")(9,"a",38),s(10),e()(),i(11,"li")(12,"a",39),_("click",function(){h(n);let m=p();return v(m.changePage(1))}),i(13,"span"),s(14,"Siguiente"),e(),U(),i(15,"svg",36),c(16,"path",40),e()()()(),Z(),i(17,"span"),s(18),e()()}if(t&2){let n=p();o(10),S(" P\xE1gina ",n.meta.current_page,""),o(8),S("Total de Resultados: ",n.meta.total,"")}}var ht=()=>["sale.create"],Le=(()=>{let r=class r{constructor(a){this.service=a,this.per_page=null,this.search="",this.loading=!1,this.data=[],this.meta=null,this.actualPage=1,this.getData()}getData(a=[5,""]){this.per_page=a[0],this.search=a[1],this.list()}list(){this.loading=!0,this.service.api("sale/getSales?included=client,car.client,car.brand,car.color,car.year,car.example","post",{company_id:this.service.user.company_id,search:this.search,perPage:this.per_page}).subscribe(a=>{this.loading=!1,this.data=a.data,a.meta?this.meta=a.meta:this.meta=null},a=>{this.loading=!1,this.service.toast("error",a.error.message)})}get page(){return this.meta==null?"":`page=${this.actualPage}`}changePage(a){let m=this.actualPage+a;1<=m&&m<=this.meta.last_page?(this.actualPage+=a,this.list()):this.service.toast("warning","No hay m\xE1s p\xE1ginas")}};r.\u0275fac=function(m){return new(m||r)(y(E))},r.\u0275cmp=b({type:r,selectors:[["app-sale-index"]],decls:26,vars:4,consts:[[3,"data"],["class","inline-flex items-center py-2.5 px-3 ml-2 text-sm font-medium text-white bg-blue-700 rounded-lg border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",3,"click",4,"setPermission"],[1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg"],[1,"w-full","text-sm","text-left","text-gray-500","dark:text-gray-400"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],["scope","col",1,"px-6","py-3"],[1,"sr-only"],["aria-label","Page navigation example"],[1,"inline-flex","items-center","py-2.5","px-3","ml-2","text-sm","font-medium","text-white","bg-blue-700","rounded-lg","border","border-blue-700","hover:bg-blue-800","focus:ring-4","focus:outline-none","focus:ring-blue-300","dark:bg-blue-600","dark:hover:bg-blue-700","dark:focus:ring-blue-800",3,"click"],[1,"fa-solid","fa-circle-plus"],[1,"bg-white","border-b","hover:bg-gray-50","text-gray-700"],[1,"px-6","py-4"],["class","bg-yellow-500 p-1 rounded-lg text-white",4,"ngIf"],["class","bg-green-500 p-1 rounded-lg text-white",4,"ngIf"],["class","bg-red-500 p-1 rounded-lg text-white",4,"ngIf"],["class","bg-blue-500 p-1 rounded-lg text-white",4,"ngIf"],[1,"px-6","py-4","w-32"],[1,"px-6","py-4","capitalize"],[1,"fa-solid","fa-car-on","text-2xl"],[1,"px-6","py-4","flex","justify-center","items-center"],["class","ml-2 bg-blue-700 text-white px-2 py-1 rounded-full",3,"click",4,"setPermission"],["target","_blank","class","ml-2 bg-sky-600 text-white px-2 py-1 rounded-full",3,"routerLink",4,"setPermission"],["class","ml-2 bg-green-700 text-white px-2 py-1 rounded-full",3,"click",4,"setPermission"],[1,"bg-yellow-500","p-1","rounded-lg","text-white"],[1,"bg-green-500","p-1","rounded-lg","text-white"],[1,"bg-red-500","p-1","rounded-lg","text-white"],[1,"bg-blue-500","p-1","rounded-lg","text-white"],[1,"ml-2","bg-blue-700","text-white","px-2","py-1","rounded-full",3,"click"],[1,"fa-brands","fa-rocketchat"],["target","_blank",1,"ml-2","bg-sky-600","text-white","px-2","py-1","rounded-full",3,"routerLink"],[1,"fa-solid","fa-print"],[1,"ml-2","bg-green-700","text-white","px-2","py-1","rounded-full",3,"click"],[1,"fa-solid","fa-book"],[1,"fa-solid","fa-marker"],[1,"flex","items-center","-space-x-px","h-10","text-base","mt-3"],["href","#","onclick","return false",1,"flex","items-center","justify-center","px-4","h-10","ml-0","leading-tight","text-gray-500","bg-white","border","border-gray-300","rounded-l-lg","hover:bg-gray-100","hover:text-gray-700","dark:bg-gray-800","dark:border-gray-700","dark:text-gray-400","dark:hover:bg-gray-700","dark:hover:text-white",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 6 10",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M5 1 1 5l4 4"],["href","#",1,"flex","items-center","justify-center","px-4","h-10","leading-tight","text-gray-500","bg-white","border","border-gray-300","hover:bg-gray-100","hover:text-gray-700","dark:bg-gray-800","dark:border-gray-700","dark:text-gray-400","dark:hover:bg-gray-700","dark:hover:text-white"],["href","#","onclick","return false",1,"flex","items-center","justify-center","px-4","h-10","leading-tight","text-gray-500","bg-white","border","border-gray-300","rounded-r-lg","hover:bg-gray-100","hover:text-gray-700","dark:bg-gray-800","dark:border-gray-700","dark:text-gray-400","dark:hover:bg-gray-700","dark:hover:text-white",3,"click"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 9 4-4-4-4"],["class","bg-white border-b hover:bg-gray-50 text-gray-700"]],template:function(m,l){m&1&&(g(0,tt,1,0,"app-load"),i(1,"app-title"),s(2,"Lista de Ventas"),e(),i(3,"app-search",0),_("data",function(u){return l.getData(u)}),g(4,it,2,0,"a",1),e(),i(5,"div",2)(6,"table",3)(7,"thead",4)(8,"tr")(9,"th",5),s(10,"VENTA"),e(),i(11,"th",5),s(12,"Estado"),e(),i(13,"th",5),s(14,"Fecha"),e(),i(15,"th",5),s(16,"Propietario"),e(),i(17,"th",5),s(18,"Veh\xEDculo"),e(),i(19,"th",5)(20,"span",6),s(21,"Edit"),e()()()(),i(22,"tbody"),ae(23,ft,26,27,"tr",41,et),e()()(),g(25,xt,19,2,"nav",7)),m&2&&(T(0,l.loading?0:-1),o(4),d("setPermission",w(3,ht)),o(19),oe(l.data),o(2),T(25,l.meta?25:-1))},dependencies:[M,K,F,z,Me,J,Se]});let t=r;return t})();function vt(t,r){t&1&&(i(0,"app-load"),s(1,"Cargando ..."),e())}function Ct(t,r){if(t&1&&(i(0,"span",30),s(1),e()),t&2){let n=p();o(),x(n.errors.km)}}function St(t,r){if(t&1&&(i(0,"span",30),s(1),e()),t&2){let n=p();o(),x(n.errors.status)}}function yt(t,r){if(t&1&&(i(0,"span",30),s(1),e()),t&2){let n=p();o(),x(n.errors.entry_date)}}function bt(t,r){if(t&1&&(i(0,"span",30),s(1),e()),t&2){let n=p();o(),x(n.errors.exit_date)}}function Et(t,r){if(t&1&&(i(0,"span",30),s(1),e()),t&2){let n=p();o(),x(n.errors.payment_date)}}function zt(t,r){if(t&1&&c(0,"nz-option",22),t&2){let n=r.$implicit;d("nzLabel",n.plate+" - "+n.example.name+" - "+n.color.name+" - "+n.year.name+" / "+n.client.document+" - "+n.client.name+" "+n.client.surname+" "+n.client.last_name)("nzValue",n.id)}}function wt(t,r){if(t&1&&(i(0,"span",30),s(1),e()),t&2){let n=p();o(),x(n.errors.car_id)}}function Mt(t,r){if(t&1&&c(0,"nz-option",22),t&2){let n=r.$implicit;d("nzLabel",n.document+" - "+n.name+" "+n.surname+" "+n.last_name)("nzValue",n.id)}}function Tt(t,r){if(t&1&&(i(0,"span",30),s(1),e()),t&2){let n=p();o(),x(n.errors.client_id)}}function It(t,r){if(t&1&&(i(0,"span",30),s(1),e()),t&2){let n=p();o(),x(n.errors.discount)}}function kt(t,r){if(t&1){let n=C();i(0,"a",31),_("nzOnConfirm",function(){h(n);let m=p();return v(m.delete())})("nzOnCancel",function(){return""}),c(1,"i",32),e()}t&2&&d("nzPopconfirmTitle","Eliminar Venta")}function Vt(t,r){if(t&1){let n=C();i(0,"a",33),_("click",function(){h(n);let m=p();return v(m.service.goPage("sale/index"))}),c(1,"i",34),e()}}function Pt(t,r){if(t&1){let n=C();i(0,"a",33),_("click",function(){h(n);let m=p();return v(m.service.goPage("sale/detail/"+m.item.id))}),c(1,"i",35),e()}}var Dt=t=>["/report-sale",t];function Ot(t,r){if(t&1&&(i(0,"a",36),c(1,"i",37),e()),t&2){let n=p();d("routerLink",q(1,Dt,n.item.id))}}var Nt=()=>["sale.destroy"],Ft=()=>["sale.index"],At=()=>["sale.detail"],Lt=()=>["sale.print"],Re=(()=>{let r=class r{constructor(a,m){this.service=a,this.route=m,this.id=null,this.loading=!1,this.item={},this.data=[],this.errors=null,m.params.subscribe(l=>{this.id=l.id,this.getInfo(),this.getData()})}ngOnInit(){}getInfo(){this.service.api(`sale/getSale/${this.id}`,"post").subscribe(a=>{this.item=a.data})}getData(){this.loading=!0;let a=this.service.api("mec/getClients","post",{company_id:this.service.user.company_id,per_page:"all"}),m=this.service.api("mec/getCars?included=client,brand,color,year,example","post",{company_id:this.service.user.company_id,per_page:"all"}),l=te(a,m),f=[];l.subscribe(u=>{f.push(u.data)},u=>{console.log(u)},()=>{this.data.clients=f[0],this.data.cars=f[1],this.loading=!1})}save(){this.loading=!0,this.errors=null,this.item.company_id=this.service.user.company_id,this.service.api(`sale/updateSale/${this.id}`,"post",this.item).subscribe(a=>{this.loading=!1,this.service.toast("success","Venta Actualizada"),this.service.goPage("sale/edit/"+a.data.id)},a=>{console.log(a),this.loading=!1,this.errors=a.error.errors,this.service.toast("error","Registro fallido")})}delete(){this.service.api(`sale/deleteSale/${this.id}`,"delete").subscribe(a=>{this.service.toast("success","Venta Eliminada"),this.service.goPage("sale/index")},a=>{console.log(a),this.service.toast("error","No se puede Eliminar")})}};r.\u0275fac=function(m){return new(m||r)(y(E),y(B))},r.\u0275cmp=b({type:r,selectors:[["app-sale-edit"]],decls:88,vars:29,consts:[[1,"overflow-x-scroll"],[1,"px-2","py-3"],[1,"grid","gap-2","mb-6","md:grid-cols-2"],[1,"label-form"],[1,"fa-brands","fa-medapps","text-red-600","font-bold"],[1,"relative"],[1,"input-icon"],[1,"fa-solid","fa-id-card-clip","text-gray-500"],["name","km","type","text","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["class","error",4,"ngIf"],[1,"fa-solid","fa-signature","text-gray-500"],["name","item.status",1,"input",3,"ngModel","ngModelChange"],["value","pending"],["value","done"],["value","debt"],["value","cancelled"],["name","entry_date","type","date","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["name","exit_date","type","date","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["name","payment_date","type","date","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["name","item.car_id","nzShowSearch","","nzAllowClear","","nzPlaceHolder","Selecciona un Veh\xEDculo",1,"w-full","p-1","bg-gray-200","rounded-lg","border-gray-300","border",3,"ngModel","ngModelChange"],["nzValue","jack",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["name","item.client_id","nzShowSearch","","nzAllowClear","","nzPlaceHolder","Selecciona un Conductor",1,"w-full","p-1","bg-gray-200","rounded-lg","border-gray-300","border",3,"ngModel","ngModelChange"],["nzValue","jack",3,"nzLabel","nzValue"],["name","discount","type","number","step","any","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],[1,"flex"],[1,"btn-save",3,"click"],[1,"fa-solid","fa-pen-to-square"],["nz-popconfirm","","nzPopconfirmPlacement","top","nzOkText","ELIMINAR","nzCancelText","CANCELAR","class","btn-delete",3,"nzPopconfirmTitle","nzOnConfirm","nzOnCancel",4,"setPermission"],["class","btn-list",3,"click",4,"setPermission"],["class","btn-list",3,"routerLink",4,"setPermission"],[1,"error"],["nz-popconfirm","","nzPopconfirmPlacement","top","nzOkText","ELIMINAR","nzCancelText","CANCELAR",1,"btn-delete",3,"nzPopconfirmTitle","nzOnConfirm","nzOnCancel"],[1,"fa-solid","fa-trash"],[1,"btn-list",3,"click"],[1,"fa-solid","fa-table"],[1,"fa-solid","fa-book"],[1,"btn-list",3,"routerLink"],[1,"fa-solid","fa-print"]],template:function(m,l){m&1&&(g(0,vt,2,0,"app-load"),i(1,"app-title"),s(2,"Actualizar Venta"),e(),i(3,"form",0)(4,"div",1)(5,"div",2)(6,"div")(7,"label",3),s(8,"KM "),c(9,"i",4),e(),i(10,"div",5)(11,"div",6),c(12,"i",7),e(),i(13,"input",8),_("ngModelChange",function(u){return l.item.km=u}),e()(),g(14,Ct,2,1,"span",9),e(),i(15,"div")(16,"label",3),s(17,"Estado Venta"),e(),i(18,"div",5)(19,"div",6),c(20,"i",10),e(),i(21,"select",11),_("ngModelChange",function(u){return l.item.status=u}),i(22,"option",12),s(23,"PENDIENTE"),e(),i(24,"option",13),s(25,"PAGADO"),e(),i(26,"option",14),s(27,"DEUDA"),e(),i(28,"option",15),s(29,"CANCELADO"),e()()(),g(30,St,2,1,"span",9),e(),i(31,"div")(32,"label",3),s(33,"Fecha Ingreso "),c(34,"i",4),e(),i(35,"div",5)(36,"div",6),c(37,"i",10),e(),i(38,"input",16),_("ngModelChange",function(u){return l.item.entry_date=u}),e()(),g(39,yt,2,1,"span",9),e(),i(40,"div")(41,"label",3),s(42,"Fecha Salida "),c(43,"i",4),e(),i(44,"div",5)(45,"div",6),c(46,"i",10),e(),i(47,"input",17),_("ngModelChange",function(u){return l.item.exit_date=u}),e()(),g(48,bt,2,1,"span",9),e(),i(49,"div")(50,"label",3),s(51,"Fecha Venta "),c(52,"i",4),e(),i(53,"div",5)(54,"div",6),c(55,"i",10),e(),i(56,"input",18),_("ngModelChange",function(u){return l.item.payment_date=u}),e()(),g(57,Et,2,1,"span",9),e(),i(58,"div")(59,"label",3),s(60,"Veh\xEDculo"),e(),i(61,"nz-select",19),_("ngModelChange",function(u){return l.item.car_id=u}),g(62,zt,1,2,"nz-option",20),e(),g(63,wt,2,1,"span",9),e(),i(64,"div")(65,"label",3),s(66,"Conductor "),c(67,"i",4),e(),i(68,"nz-select",21),_("ngModelChange",function(u){return l.item.client_id=u}),c(69,"nz-option",22),g(70,Mt,1,2,"nz-option",20),e(),g(71,Tt,2,1,"span",9),e(),i(72,"div")(73,"label",3),s(74,"Descuento "),c(75,"i",4),e(),i(76,"div",5)(77,"div",6),c(78,"i",10),e(),i(79,"input",23),_("ngModelChange",function(u){return l.item.discount=u}),e()(),g(80,It,2,1,"span",9),e()(),i(81,"div",24)(82,"button",25),_("click",function(){return l.save()}),c(83,"i",26),e(),g(84,kt,2,1,"a",27)(85,Vt,2,0,"a",28)(86,Pt,2,0,"a",28)(87,Ot,2,3,"a",29),e()()()),m&2&&(T(0,l.loading?0:-1),o(13),d("ngModel",l.item.km),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.status),o(9),d("ngIf",l.errors),o(8),d("ngModel",l.item.entry_date),o(),d("ngIf",l.errors),o(8),d("ngModel",l.item.exit_date),o(),d("ngIf",l.errors),o(8),d("ngModel",l.item.payment_date),o(),d("ngIf",l.errors),o(4),d("ngModel",l.item.car_id),o(),d("ngForOf",l.data.cars),o(),d("ngIf",l.errors),o(5),d("ngModel",l.item.client_id),o(),d("nzLabel","Ninguno")("nzValue",null),o(),d("ngForOf",l.data.clients),o(),d("ngIf",l.errors),o(8),d("ngModel",l.item.discount),o(),d("ngIf",l.errors),o(4),d("setPermission",w(25,Nt)),o(),d("setPermission",w(26,Ft)),o(),d("setPermission",w(27,At)),o(),d("setPermission",w(28,Lt)))},dependencies:[I,M,K,F,z,N,Ee,ze,k,R,be,V,P,O,D,W,J,A,L]});let t=r;return t})();function jt(t,r){t&1&&c(0,"app-load")}function Rt(t,r){if(t&1&&c(0,"nz-option",18),t&2){let n=r.$implicit;d("nzLabel",n.name)("nzValue",n.id)}}function $t(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.product_id)}}function Gt(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.price_buy)}}function Ut(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.price_sell)}}function Ht(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.quantity)}}function qt(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.date_sale)}}var $e=(()=>{let r=class r{constructor(a){this.service=a,this.event=new H,this.item={},this.loading=!1,this.products=[],this.errors=null,this.item.quantity=1,this.item.date_sale=new Date().toISOString().slice(0,10),this.getList()}getList(){this.loading=!0,this.service.api("mec/getProducts","post",{company_id:this.service.user.company_id}).subscribe(a=>{this.loading=!1,this.products=a.data},a=>{this.loading=!1,this.service.toast("error",a.error.message)})}select(a){let m=this.products.find(l=>l.id===a);this.item.price_buy=m.price_buy,this.item.price_sell=m.price_sell}save(){this.item.sale_id=this.product.id,this.loading=!0,this.errors=null,this.service.api("sale/addProduct","post",this.item).subscribe(a=>{this.event.emit(a.data),this.loading=!1,this.service.toast("success","Producto Agregado"),this.clean()},a=>{console.log(a),this.loading=!1,this.errors=a.error.errors,this.service.toast("error","Registro fallido")})}clean(){this.item={},this.item.quantity=1,this.item.date_sale=new Date().toISOString().slice(0,10)}};r.\u0275fac=function(m){return new(m||r)(y(E))},r.\u0275cmp=b({type:r,selectors:[["app-sale-product"]],inputs:{product:"product"},outputs:{event:"event"},decls:45,vars:12,consts:[[4,"ngIf"],[1,"overflow-x-scroll"],[1,"px-2","py-3"],[1,"grid","gap-2","mb-6"],[1,"label-form"],["name","item.product_id","nzShowSearch","","nzAllowClear","","nzPlaceHolder","Selecciona un Producto",1,"w-full","p-1","bg-gray-200","rounded-lg","border-gray-300","border",3,"ngModel","ngModelChange"],["nzValue","jack",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],[1,"relative"],[1,"input-icon"],[1,"fa-solid","fa-box","text-gray-500"],["name","price_buy","type","number","step","any","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["name","price_sell","type","number","step","any","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["name","quantity","type","number","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],[1,"fa-solid","fa-calendar-days","text-gray-500"],["name","date_sale","type","date","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],[1,"text-white","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:outline-none","focus:ring-blue-300","font-medium","rounded-lg","text-sm","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"click"],[1,"fa-solid","fa-floppy-disk"],["nzValue","jack",3,"nzLabel","nzValue"],[1,"error"]],template:function(m,l){m&1&&(g(0,jt,1,0,"app-load",0),i(1,"form",1)(2,"div",2)(3,"div",3)(4,"div")(5,"label",4),s(6,"Producto"),e(),i(7,"nz-select",5),_("ngModelChange",function(u){return l.item.product_id=u})("ngModelChange",function(u){return l.select(u)}),g(8,Rt,1,2,"nz-option",6),e(),g(9,$t,2,1,"span",7),e(),i(10,"div")(11,"label",4),s(12,"S/. P.Compra Unitario"),e(),i(13,"div",8)(14,"div",9),c(15,"i",10),e(),i(16,"input",11),_("ngModelChange",function(u){return l.item.price_buy=u}),e()(),g(17,Gt,2,1,"span",7),e(),i(18,"div")(19,"label",4),s(20,"S/. P.Venta Unitario"),e(),i(21,"div",8)(22,"div",9),c(23,"i",10),e(),i(24,"input",12),_("ngModelChange",function(u){return l.item.price_sell=u}),e()(),g(25,Ut,2,1,"span",7),e(),i(26,"div")(27,"label",4),s(28,"Cantidad"),e(),i(29,"div",8)(30,"div",9),c(31,"i",10),e(),i(32,"input",13),_("ngModelChange",function(u){return l.item.quantity=u}),e()(),g(33,Ht,2,1,"span",7),e(),i(34,"div")(35,"label",4),s(36,"Fecha Venta"),e(),i(37,"div",8)(38,"div",9),c(39,"i",14),e(),i(40,"input",15),_("ngModelChange",function(u){return l.item.date_sale=u}),e()(),g(41,qt,2,1,"span",7),e()(),i(42,"button",16),_("click",function(){return l.save()}),c(43,"i",17),s(44," REGISTRAR "),e()()()),m&2&&(d("ngIf",l.loading),o(7),d("ngModel",l.item.product_id),o(),d("ngForOf",l.products),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.price_buy),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.price_sell),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.quantity),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.date_sale),o(),d("ngIf",l.errors))},dependencies:[I,M,z,N,k,R,V,P,O,D,A,L]});let t=r;return t})();function Kt(t,r){t&1&&c(0,"app-load")}function Jt(t,r){if(t&1&&c(0,"nz-option",16),t&2){let n=r.$implicit;d("nzLabel",n.name)("nzValue",n.id)}}function Qt(t,r){if(t&1&&(i(0,"span",17),s(1),e()),t&2){let n=p();o(),x(n.errors.service_id)}}function Wt(t,r){if(t&1&&(i(0,"span",17),s(1),e()),t&2){let n=p();o(),x(n.errors.price_service)}}function Xt(t,r){if(t&1&&(i(0,"span",17),s(1),e()),t&2){let n=p();o(),x(n.errors.date_service)}}var Ge=(()=>{let r=class r{constructor(a){this.servicio=a,this.event=new H,this.item={},this.loading=!1,this.services=[],this.errors=null,this.item.date_service=new Date().toISOString().slice(0,10),this.getList()}getList(){this.loading=!0,this.servicio.api("mec/getServices","post",{company_id:this.servicio.user.company_id}).subscribe(a=>{console.log(a),this.services=a.data,this.loading=!1},a=>{this.loading=!1,this.service.toast("error",a.error.message)})}select(a){let m=this.services.find(l=>l.id===a);this.item.price_buy=m.price_buy,this.item.price_sell=m.price_sell}save(){this.item.sale_id=this.service.id,this.loading=!0,this.errors=null,this.servicio.api("sale/addService","post",this.item).subscribe(a=>{this.event.emit(a.data),this.loading=!1,this.servicio.toast("success","Servicio Agregado"),this.clean()},a=>{console.log(a),this.loading=!1,this.errors=a.error.errors,this.servicio.toast("error","Registro fallido")})}clean(){this.item={},this.item.date_service=new Date().toISOString().slice(0,10)}};r.\u0275fac=function(m){return new(m||r)(y(E))},r.\u0275cmp=b({type:r,selectors:[["app-sale-service"]],inputs:{service:"service"},outputs:{event:"event"},decls:29,vars:8,consts:[[4,"ngIf"],[1,"overflow-x-scroll"],[1,"px-2","py-3"],[1,"grid","gap-2","mb-6"],[1,"label-form"],["name","item.service_id","nzShowSearch","","nzAllowClear","","nzPlaceHolder","Selecciona un Servicio",1,"w-full","p-1","bg-gray-200","rounded-lg","border-gray-300","border",3,"ngModel","ngModelChange"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],[1,"relative"],[1,"input-icon"],[1,"fa-solid","fa-box","text-gray-500"],["name","price_service","type","number","step","any","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],[1,"fa-solid","fa-calendar-days","text-gray-500"],["name","date_service","type","date","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],[1,"text-white","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:outline-none","focus:ring-blue-300","font-medium","rounded-lg","text-sm","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"click"],[1,"fa-solid","fa-floppy-disk"],[3,"nzLabel","nzValue"],[1,"error"]],template:function(m,l){m&1&&(g(0,Kt,1,0,"app-load",0),i(1,"form",1)(2,"div",2)(3,"div",3)(4,"div")(5,"label",4),s(6,"Servicio"),e(),i(7,"nz-select",5),_("ngModelChange",function(u){return l.item.service_id=u})("ngModelChange",function(u){return l.select(u)}),g(8,Jt,1,2,"nz-option",6),e(),g(9,Qt,2,1,"span",7),e(),i(10,"div")(11,"label",4),s(12,"S/. P.Servicio"),e(),i(13,"div",8)(14,"div",9),c(15,"i",10),e(),i(16,"input",11),_("ngModelChange",function(u){return l.item.price_service=u}),e()(),g(17,Wt,2,1,"span",7),e(),i(18,"div")(19,"label",4),s(20,"Fecha Servicio"),e(),i(21,"div",8)(22,"div",9),c(23,"i",12),e(),i(24,"input",13),_("ngModelChange",function(u){return l.item.date_service=u}),e()(),g(25,Xt,2,1,"span",7),e()(),i(26,"button",14),_("click",function(){return l.save()}),c(27,"i",15),s(28," REGISTRAR "),e()()()),m&2&&(d("ngIf",l.loading),o(7),d("ngModel",l.item.service_id),o(),d("ngForOf",l.services),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.price_service),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.date_service),o(),d("ngIf",l.errors))},dependencies:[I,M,z,N,k,R,V,P,O,D,A,L]});let t=r;return t})();function Zt(t,r){t&1&&c(0,"app-load")}function ei(t,r){if(t&1&&c(0,"nz-option",18),t&2){let n=r.$implicit;d("nzLabel",n.name)("nzValue",n.id)}}function ti(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.box_id)}}function ii(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.detail)}}function ni(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.amount)}}function ai(t,r){if(t&1&&(i(0,"span",19),s(1),e()),t&2){let n=p();o(),x(n.errors.date_payment)}}var Ue=(()=>{let r=class r{constructor(a){this.service=a,this.event=new H,this.item={},this.loading=!1,this.boxes=[],this.errors=null,this.item.date_payment=new Date().toISOString().slice(0,10),this.getList()}getList(){this.loading=!0,this.service.api("mec/getBoxes","post",{company_id:this.service.user.company_id}).subscribe(a=>{this.loading=!1,this.boxes=a.data},a=>{this.loading=!1,this.service.toast("error",a.error.message)})}save(){this.item.sale_id=this.sale.id,this.loading=!0,this.errors=null,this.service.api("sale/addPayment","post",this.item).subscribe(a=>{this.event.emit(a.data),this.loading=!1,this.service.toast("success","Pago Agregado"),this.clean()},a=>{console.log(a),this.loading=!1,this.errors=a.error.errors,this.service.toast("error","Registro fallido")})}clean(){this.item={},this.item.date_payment=new Date().toISOString().slice(0,10)}};r.\u0275fac=function(m){return new(m||r)(y(E))},r.\u0275cmp=b({type:r,selectors:[["app-sale-payment"]],inputs:{sale:"sale"},outputs:{event:"event"},decls:38,vars:10,consts:[[4,"ngIf"],[1,"overflow-x-scroll"],[1,"px-2","py-3"],[1,"grid","gap-2","mb-6"],[1,"label-form"],["name","item.box_id","nzShowSearch","","nzAllowClear","","nzPlaceHolder","Selecciona un Producto",1,"w-full","p-1","bg-gray-200","rounded-lg","border-gray-300","border",3,"ngModel","ngModelChange"],["nzValue","jack",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["class","error",4,"ngIf"],[1,"fa-brands","fa-medapps","text-red-600","font-bold"],[1,"relative"],[1,"input-icon"],[1,"fa-solid","fa-box","text-gray-500"],["name","detail","type","text","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],["name","amount","type","number","step","any","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],[1,"fa-solid","fa-calendar-days","text-gray-500"],["name","date_payment","type","date","autocomplete","off",1,"input",3,"ngModel","ngModelChange"],[1,"text-white","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:outline-none","focus:ring-blue-300","font-medium","rounded-lg","text-sm","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"click"],[1,"fa-solid","fa-floppy-disk"],["nzValue","jack",3,"nzLabel","nzValue"],[1,"error"]],template:function(m,l){m&1&&(g(0,Zt,1,0,"app-load",0),i(1,"form",1)(2,"div",2)(3,"div",3)(4,"div")(5,"label",4),s(6,"Caja"),e(),i(7,"nz-select",5),_("ngModelChange",function(u){return l.item.box_id=u}),g(8,ei,1,2,"nz-option",6),e(),g(9,ti,2,1,"span",7),e(),i(10,"div")(11,"label",4),s(12,"Detalle"),c(13,"i",8),e(),i(14,"div",9)(15,"div",10),c(16,"i",11),e(),i(17,"input",12),_("ngModelChange",function(u){return l.item.detail=u}),e()(),g(18,ii,2,1,"span",7),e(),i(19,"div")(20,"label",4),s(21,"S/. Pago"),e(),i(22,"div",9)(23,"div",10),c(24,"i",11),e(),i(25,"input",13),_("ngModelChange",function(u){return l.item.amount=u}),e()(),g(26,ni,2,1,"span",7),e(),i(27,"div")(28,"label",4),s(29,"Fecha Pago"),e(),i(30,"div",9)(31,"div",10),c(32,"i",14),e(),i(33,"input",15),_("ngModelChange",function(u){return l.item.date_payment=u}),e()(),g(34,ai,2,1,"span",7),e()(),i(35,"button",16),_("click",function(){return l.save()}),c(36,"i",17),s(37," REGISTRAR "),e()()()),m&2&&(d("ngIf",l.loading),o(7),d("ngModel",l.item.box_id),o(),d("ngForOf",l.boxes),o(),d("ngIf",l.errors),o(8),d("ngModel",l.item.detail),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.amount),o(),d("ngIf",l.errors),o(7),d("ngModel",l.item.date_payment),o(),d("ngIf",l.errors))},dependencies:[I,M,z,N,k,R,V,P,O,D,A,L]});let t=r;return t})();function li(t,r){t&1&&c(0,"app-load")}function si(t,r){t&1&&(i(0,"span",30),s(1," DEUDA "),e())}function mi(t,r){t&1&&(i(0,"span",31),s(1," PENDIENTE "),e())}function di(t,r){t&1&&(i(0,"span",32),s(1," CANCELADO "),e())}function ci(t,r){t&1&&(i(0,"span",33),s(1," PAGADO "),e())}var pi=t=>["/report-sale",t];function _i(t,r){if(t&1&&(i(0,"a",34),c(1,"i",35),e()),t&2){let n=p(2);d("routerLink",q(1,pi,n.detail.sale.id))}}function ui(t,r){if(t&1){let n=C();i(0,"a",36),_("click",function(){h(n);let m=p(2);return v(m.service.goPage("sale/edit/"+m.detail.sale.id))}),c(1,"i",37),e()}}function gi(t,r){if(t&1){let n=C();i(0,"a",36),_("click",function(){h(n);let m=p(2);return v(m.service.goPage("car/history/"+m.detail.sale.car_id))}),c(1,"i",38),e()}}function fi(t,r){if(t&1){let n=C();re(0),i(1,"app-sale-product",41),_("event",function(){h(n);let m=p(3);return v(m.getData())}),e(),le()}if(t&2){let n=p(3);o(),d("product",n.detail.sale)}}function xi(t,r){if(t&1){let n=C();i(0,"nz-modal",39),_("nzVisibleChange",function(m){h(n);let l=p(2);return v(l.visible=m)})("nzOnCancel",function(){h(n);let m=p(2);return v(m.cancel())})("nzOnOk",function(){h(n);let m=p(2);return v(m.ok())}),g(1,fi,2,1,"ng-container",40),e()}if(t&2){let n=p(2);d("nzVisible",n.visible)}}function hi(t,r){if(t&1){let n=C();i(0,"tr",22)(1,"td",42),s(2),e(),i(3,"td",42),c(4,"p-image",43),e(),i(5,"td",44),s(6),e(),i(7,"td",45),s(8),e(),i(9,"td",45),s(10),e(),i(11,"td",42),s(12),e(),i(13,"td",42),s(14),e(),i(15,"td",42),s(16),e(),i(17,"td",46)(18,"a",47),_("nzOnConfirm",function(){let l=h(n).$implicit,f=p(2);return v(f.deleteProduct(l))})("nzOnCancel",function(){return""}),c(19,"i",48),e()()()}if(t&2){let n=r.$implicit,a=r.index,m=p(2);o(2),S(" ",a+1," "),o(2),d("src",n.storage?m.service.apiUrl+"/"+n.storage:"assets/img/logo.png")("preview",!0),o(2),x(n.name),o(2),x(n.pivot.date_sale),o(2),x(n.pivot.quantity),o(2),S("S/. ",n.pivot.price_buy,""),o(2),S("S/. ",n.pivot.price_sell,""),o(2),S(" S/. ",n.pivot.price_sell*n.pivot.quantity," "),o(2),d("nzPopconfirmTitle","Eliminar Producto "+n.name+"?")}}function vi(t,r){if(t&1){let n=C();re(0),i(1,"app-sale-service",50),_("event",function(){h(n);let m=p(3);return v(m.getData())}),e(),le()}if(t&2){let n=p(3);o(),d("service",n.detail.sale)}}function Ci(t,r){if(t&1){let n=C();i(0,"nz-modal",49),_("nzVisibleChange",function(m){h(n);let l=p(2);return v(l.visible=m)})("nzOnCancel",function(){h(n);let m=p(2);return v(m.cancel())})("nzOnOk",function(){h(n);let m=p(2);return v(m.ok())}),g(1,vi,2,1,"ng-container",40),e()}if(t&2){let n=p(2);d("nzVisible",n.visible)}}function Si(t,r){if(t&1){let n=C();i(0,"tr",22)(1,"td",42),s(2),e(),i(3,"td",42),c(4,"p-image",43),e(),i(5,"td",44),s(6),e(),i(7,"td",42),s(8),e(),i(9,"td",42),s(10),e(),i(11,"td",46)(12,"a",47),_("nzOnConfirm",function(){let l=h(n).$implicit,f=p(2);return v(f.deleteService(l))})("nzOnCancel",function(){return""}),c(13,"i",48),e()()()}if(t&2){let n=r.$implicit,a=r.index,m=p(2);o(2),S(" ",a+1," "),o(2),d("src",n.storage?m.service.apiUrl+"/"+n.storage:"assets/img/logo.png")("preview",!0),o(2),x(n.name),o(2),x(n.pivot.date_service),o(2),S("S/. ",n.pivot.price_service,""),o(2),d("nzPopconfirmTitle","Eliminar Servicio "+n.name+"?")}}function yi(t,r){if(t&1){let n=C();re(0),i(1,"app-sale-payment",51),_("event",function(){h(n);let m=p(3);return v(m.getData())}),e(),le()}if(t&2){let n=p(3);o(),d("sale",n.detail.sale)}}function bi(t,r){if(t&1){let n=C();i(0,"nz-modal",49),_("nzVisibleChange",function(m){h(n);let l=p(2);return v(l.visible=m)})("nzOnCancel",function(){h(n);let m=p(2);return v(m.cancel())})("nzOnOk",function(){h(n);let m=p(2);return v(m.ok())}),g(1,yi,2,1,"ng-container",40),e()}if(t&2){let n=p(2);d("nzVisible",n.visible)}}function Ei(t,r){if(t&1){let n=C();i(0,"tr",22)(1,"td",42),s(2),e(),i(3,"td",42),c(4,"p-image",43),e(),i(5,"td",44),s(6),e(),i(7,"td",44),s(8),e(),i(9,"td",42),s(10),e(),i(11,"td",42),s(12),e(),i(13,"td",46)(14,"a",47),_("nzOnConfirm",function(){let l=h(n).$implicit,f=p(2);return v(f.deletePayment(l))})("nzOnCancel",function(){return""}),c(15,"i",48),e()()()}if(t&2){let n=r.$implicit,a=r.index,m=p(2);o(2),S(" ",a+1," "),o(2),d("src",n.storage?m.service.apiUrl+"/"+n.storage:"assets/img/logo.png")("preview",!0),o(2),x(n.box.name),o(2),x(n.detail),o(2),x(n.date_payment),o(2),S("S/. ",n.amount,""),o(2),d("nzPopconfirmTitle","Eliminar Pago "+n.amount+"?")}}var zi=()=>["sale.print"],wi=()=>["sale.edit"],Mi=()=>["car.history"];function Ti(t,r){if(t&1){let n=C();i(0,"app-title"),s(1),g(2,si,2,0,"span",1)(3,mi,2,0,"span",2)(4,di,2,0,"span",3)(5,ci,2,0,"span",4)(6,_i,2,3,"a",5)(7,ui,2,0,"a",6)(8,gi,2,0,"a",6),e(),i(9,"div",7)(10,"table",8)(11,"thead",9)(12,"tr")(13,"th",10),s(14,"TOTAL SERVICIOS"),e(),i(15,"th",10),s(16,"PAGOS"),e(),i(17,"th",10),s(18,"DESCUENTO"),e(),i(19,"th",10),s(20,"PENDIENTE"),e()()(),i(21,"tbody")(22,"tr",11)(23,"td",12),s(24),e(),i(25,"td",13),s(26),e(),i(27,"td",13),s(28),e(),i(29,"td",14),s(30),e()()()()(),i(31,"div",15)(32,"p",16),s(33,"PRODUCTOS"),e(),i(34,"button",17),_("click",function(){h(n);let m=p();return v(m.showModal("product"))}),c(35,"i",18),e(),g(36,xi,2,1,"nz-modal",19),e(),i(37,"div",7)(38,"table",8)(39,"thead",9)(40,"tr")(41,"th",10),s(42,"ID"),e(),i(43,"th",10),s(44,"Foto"),e(),i(45,"th",10),s(46,"Producto"),e(),i(47,"th",10),s(48,"Fecha"),e(),i(49,"th",10),s(50,"Cantidad"),e(),i(51,"th",10),s(52,"P.Compra"),e(),i(53,"th",10),s(54,"P.Venta"),e(),i(55,"th",10),s(56,"Total"),e(),i(57,"th",10)(58,"span",20),s(59,"Edit"),e()()()(),i(60,"tbody"),g(61,hi,20,10,"tr",21),i(62,"tr",22),c(63,"td",23),i(64,"td",24),s(65),e()()()()(),i(66,"div",15)(67,"p",16),s(68,"SERVICIOS"),e(),i(69,"button",17),_("click",function(){h(n);let m=p();return v(m.showModal("service"))}),c(70,"i",25),e(),g(71,Ci,2,1,"nz-modal",26),e(),i(72,"div",7)(73,"table",8)(74,"thead",9)(75,"tr")(76,"th",10),s(77,"ID"),e(),i(78,"th",10),s(79,"Foto"),e(),i(80,"th",10),s(81,"Servicio"),e(),i(82,"th",10),s(83,"Fecha"),e(),i(84,"th",10),s(85,"P.Servicio"),e(),i(86,"th",10)(87,"span",20),s(88,"Edit"),e()()()(),i(89,"tbody"),g(90,Si,14,7,"tr",21),i(91,"tr",22),c(92,"td",27),i(93,"td",24),s(94),e()()()()(),i(95,"div",15)(96,"p",16),s(97,"PAGOS"),e(),i(98,"button",17),_("click",function(){h(n);let m=p();return v(m.showModal("payment"))}),c(99,"i",28),e(),g(100,bi,2,1,"nz-modal",26),e(),i(101,"div",7)(102,"table",8)(103,"thead",9)(104,"tr")(105,"th",10),s(106,"ID"),e(),i(107,"th",10),s(108,"Foto"),e(),i(109,"th",10),s(110,"Caja"),e(),i(111,"th",10),s(112,"Detalle"),e(),i(113,"th",10),s(114,"Fecha"),e(),i(115,"th",10),s(116,"Monto"),e(),i(117,"th",10)(118,"span",20),s(119,"Edit"),e()()()(),i(120,"tbody"),g(121,Ei,16,8,"tr",21),i(122,"tr",22),c(123,"td",29),i(124,"td",24),s(125),e()()()()()}if(t&2){let n=p();o(),S("Venta N\xB0 ",n.detail.sale.id," "),o(),d("ngIf",n.detail.sale.status=="debt"),o(),d("ngIf",n.detail.sale.status=="pending"),o(),d("ngIf",n.detail.sale.status=="cancelled"),o(),d("ngIf",n.detail.sale.status=="done"),o(),d("setPermission",w(21,zi)),o(),d("setPermission",w(22,wi)),o(),d("setPermission",w(23,Mi)),o(16),S("S/. ",n.detail.total,""),o(2),S("S/. ",n.detail.totalPayments,""),o(2),S("S/. ",n.detail.sale.discount,""),o(2),S("S/. ",n.detail.pending,""),o(6),d("ngIf",n.modal=="product"),o(25),d("ngForOf",n.detail.products),o(4),S(" S/. ",n.detail.totalProducts," "),o(6),d("ngIf",n.modal=="service"),o(19),d("ngForOf",n.detail.services),o(4),S(" S/. ",n.detail.totalServices," "),o(6),d("ngIf",n.modal=="payment"),o(21),d("ngForOf",n.detail.payments),o(4),S(" S/. ",n.detail.totalPayments," ")}}var He=(()=>{let r=class r{constructor(a,m){this.service=a,this.route=m,this.id=null,this.loading=!1,this.detail=null,this.modal="product",this.visible=!1,m.params.subscribe(l=>{this.id=l.id,this.getData()})}getData(){this.loading=!0,this.service.api(`sale/getSaleDetail/${this.id}`,"get").subscribe(a=>{this.detail=a,this.loading=!1},a=>{console.log(a),this.loading=!1})}showModal(a){this.modal=a,this.visible=!0}ok(){this.modal="",this.visible=!1}cancel(){this.modal="",this.visible=!1}deleteProduct(a){this.loading=!0,this.service.api("sale/removeProduct","post",a.pivot).subscribe(m=>{this.loading=!1,this.service.toast("success","Producto Eliminado"),this.getData()},m=>{console.log(m),this.loading=!1,this.service.toast("error","Eliminacio\u0301n fallida")})}deleteService(a){this.loading=!0,this.service.api("sale/removeService","post",a.pivot).subscribe(m=>{this.loading=!1,this.service.toast("success","Servicio Eliminado"),this.getData()},m=>{console.log(m),this.loading=!1,this.service.toast("error","Eliminacio\u0301n fallida")})}deletePayment(a){this.loading=!0,this.service.api("sale/removePayment","post",{payment_id:a.id}).subscribe(m=>{this.loading=!1,this.service.toast("success","Pago Eliminado"),this.getData()},m=>{console.log(m),this.loading=!1,this.service.toast("error","Eliminacio\u0301n fallida")})}};r.\u0275fac=function(m){return new(m||r)(y(E),y(B))},r.\u0275cmp=b({type:r,selectors:[["app-sale-detail"]],decls:2,vars:2,consts:[[4,"ngIf"],["class","bg-yellow-500 p-1 rounded-lg text-white mr-1",4,"ngIf"],["class","bg-green-500 p-1 rounded-lg text-white mr-1",4,"ngIf"],["class","bg-red-500 p-1 rounded-lg text-white mr-1",4,"ngIf"],["class","bg-blue-500 p-1 rounded-lg text-white mr-1",4,"ngIf"],["target","_blank","class","ml-2 bg-sky-600 text-white px-2 py-1 rounded-full",3,"routerLink",4,"setPermission"],["target","_blank","class","ml-2 bg-sky-600 text-white px-2 py-1 rounded-full",3,"click",4,"setPermission"],[1,"relative","overflow-x-auto","shadow-md","sm:rounded-lg"],[1,"w-full","text-sm","text-left","text-gray-500","dark:text-gray-400"],[1,"text-xs","text-gray-700","uppercase","bg-gray-50","dark:bg-gray-700","dark:text-gray-400"],["scope","col",1,"px-6","py-3"],[1,"bg-white","border-b","hover:bg-gray-50","text-gray-700","font-bold"],[1,"px-6","py-4","text-green-700"],[1,"px-6","py-4","text-red-700"],[1,"px-6","py-4","text-blue-700"],[1,"flex","items-center","justify-start","mt-2"],[1,"text-lg","font-bold"],["type","button",1,"text-white","bg-blue-700","hover:bg-blue-800","focus:ring-4","focus:ring-blue-300","font-bold","rounded-lg","text-lg","py-2","px-3","m-1","focus:outline-none",3,"click"],[1,"fa-solid","fa-boxes-stacked"],["nzTitle","AGREGAR PRODUCTOS","nzOkDisabled","","nzOkText",".","nzCancelText","CANCELAR",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk",4,"ngIf"],[1,"sr-only"],["class","bg-white border-b hover:bg-gray-50 text-gray-700",4,"ngFor","ngForOf"],[1,"bg-white","border-b","hover:bg-gray-50","text-gray-700"],["colSpan","7",1,"px-6","py-4"],[1,"px-6","py-4","font-bold","text-green-600"],[1,"fa-solid","fa-gear"],["nzTitle","AGREGAR SERVICIOS","nzOkDisabled","","nzOkText",".","nzCancelText","CANCELAR",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk",4,"ngIf"],["colSpan","4",1,"px-6","py-4"],[1,"fa-solid","fa-money-bills"],["colSpan","5",1,"px-6","py-4"],[1,"bg-yellow-500","p-1","rounded-lg","text-white","mr-1"],[1,"bg-green-500","p-1","rounded-lg","text-white","mr-1"],[1,"bg-red-500","p-1","rounded-lg","text-white","mr-1"],[1,"bg-blue-500","p-1","rounded-lg","text-white","mr-1"],["target","_blank",1,"ml-2","bg-sky-600","text-white","px-2","py-1","rounded-full",3,"routerLink"],[1,"fa-solid","fa-print"],["target","_blank",1,"ml-2","bg-sky-600","text-white","px-2","py-1","rounded-full",3,"click"],[1,"fa-solid","fa-marker"],[1,"fa-solid","fa-list-check"],["nzTitle","AGREGAR PRODUCTOS","nzOkDisabled","","nzOkText",".","nzCancelText","CANCELAR",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],[3,"product","event"],[1,"px-6","py-4"],["alt","Perfil","width","30",3,"src","preview"],[1,"px-6","py-4","capitalize"],[1,"px-6","py-4","text-center"],[1,"px-6","py-4","text-right","flex"],["nz-popconfirm","","nzPopconfirmPlacement","top","nzOkText","ELIMINAR","nzCancelText","CANCELAR",1,"ml-2","text-white","bg-red-700","hover:bg-red-800","focus:ring-4","focus:outline-none","focus:ring-red-300","font-medium","rounded-lg","text-sm","w-full","sm:w-auto","px-5","py-2.5","text-center",3,"nzPopconfirmTitle","nzOnConfirm","nzOnCancel"],[1,"fa-solid","fa-circle-minus"],["nzTitle","AGREGAR SERVICIOS","nzOkDisabled","","nzOkText",".","nzCancelText","CANCELAR",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[3,"service","event"],[3,"sale","event"]],template:function(m,l){m&1&&g(0,li,1,0,"app-load",0)(1,Ti,126,24),m&2&&(d("ngIf",l.loading),o(),T(1,l.detail?1:-1))},dependencies:[I,M,K,F,z,W,se,J,De,Pe,$e,Ge,Ue]});let t=r;return t})();var Ii=(t,r)=>r.id;function ki(t,r){t&1&&(i(0,"app-load"),s(1,"Cargando ..."),e())}function Vi(t,r){if(t&1&&(i(0,"div"),s(1),e()),t&2){let n=p().$implicit;o(),S(" ",n.content," ")}}function Pi(t,r){if(t&1&&c(0,"p-image",21),t&2){let n=p().$implicit,a=p();d("src",n.storage?a.service.apiUrl+"/"+n.storage:"assets/img/logo.png")("preview",!0)}}function Di(t,r){if(t&1){let n=C();i(0,"div")(1,"div")(2,"img",19),_("nzOnConfirm",function(){let l=h(n).$implicit,f=p();return v(f.deleteMessage(l.id))})("nzOnCancel",function(){h(n);let m=p();return v(m.cancel())}),e(),i(3,"div",20),g(4,Vi,2,1,"div")(5,Pi,1,2),e()()()}if(t&2){let n=r.$implicit,a=p();ce(n.user_id==a.service.user.id?"col-start-6 col-end-13 p-3 rounded-lg":"col-start-1 col-end-8 p-3 rounded-lg"),o(),ce(n.user_id==a.service.user.id?"flex items-center justify-start flex-row-reverse":"flex flex-row items-center"),o(),d("src",n.user.storage?a.service.apiUrl+"/"+n.user.storage:"assets/img/logo.png",ge),o(2),T(4,n.type=="text"?4:5)}}var qe=(()=>{let r=class r{constructor(a,m){this.service=a,this.route=m,this.id=null,this.loading=!1,this.item={},this.messages=[],this.errors=null,this.msj={},this.msj.content="",m.params.subscribe(l=>{this.id=l.id,this.getInfo(),this.getMessages()})}getInfo(){this.service.api(`sale/getSale/${this.id}`,"post").subscribe(a=>{this.item=a.data})}getMessages(){this.service.api(`mec/getMessages/${this.id}`,"get").subscribe(a=>{console.log(a),this.messages=a.messages})}sendMessage(){this.msj.content.trim().length>0?(this.loading=!0,this.msj.type="text",this.msj.user_id=this.service.user.id,this.msj.sale_id=this.id,this.service.api("mec/sendMessage","post",this.msj).subscribe(a=>{this.loading=!1,this.getMessages(),this.msj={},this.service.toast("success","Mensaje enviado")})):this.service.toast("error","Escribe un mensaje")}onFileSelected(a){this.loading=!0;let m=a.target.files[0];if(m){this.file=m;let l=new FormData;l.append("content",this.file),l.append("type","image"),l.append("sale_id",this.id+""),l.append("user_id",this.service.user.id),this.service.api("mec/sendMessage","post",l).subscribe(f=>{this.loading=!1,this.service.toast("success","Imagen subida"),this.file=null,this.getMessages(),this.msj={}},f=>{this.loading=!1,console.log(f),this.service.toast("error",f.error.message)})}}deleteMessage(a){this.service.api(`mec/deleteMessage/${a}`,"delete").subscribe(m=>{this.service.toast("success","Mensaje eliminado"),this.getMessages()})}cancel(){}};r.\u0275fac=function(m){return new(m||r)(y(E),y(B))},r.\u0275cmp=b({type:r,selectors:[["app-sale-message"]],decls:26,vars:3,consts:[[1,"flex","flex-col","flex-auto","h-[80vh]"],[1,"flex","flex-col","flex-auto","flex-shrink-0","rounded-2xl","bg-gray-100","h-full","p-4"],[1,"flex","flex-col","h-full","overflow-x-auto","mb-4"],[1,"flex","flex-col","h-full"],[1,"grid","grid-cols-12","gap-y-2"],[1,"flex","flex-row","items-center","h-16","rounded-xl","bg-white","w-full","px-4"],["type","file",2,"display","none",3,"change"],["fileInput",""],[1,"flex","items-center","justify-center","text-gray-400","hover:text-gray-600",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-5","h-5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"],[1,"flex-grow","ml-4"],[1,"relative","w-full"],["action",""],["name","content","type","text",1,"flex","w-full","border","rounded-xl","focus:outline-none","focus:border-indigo-300","pl-4","h-10",3,"ngModel","ngModelChange"],[1,"ml-4"],[1,"flex","items-center","justify-center","bg-indigo-500","hover:bg-indigo-600","rounded-xl","text-white","px-4","py-1","flex-shrink-0",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg",1,"w-4","h-4","transform","rotate-45","my-1"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 19l9 2-9-18-9 18 9-2zm0 0v-8"],["nz-popconfirm","","nzPopconfirmTitle","Eliminar Mensaje?","nzPopconfirmPlacement","bottom","alt","",1,"h-10","w-10","rounded-full",3,"src","nzOnConfirm","nzOnCancel"],[1,"relative","mr-3","text-sm","bg-indigo-100","py-2","px-4","shadow","rounded-xl"],["alt","","alt","Perfil","width","100",3,"src","preview"],[3,"class"]],template:function(m,l){if(m&1){let f=C();g(0,ki,2,0,"app-load"),i(1,"app-title"),s(2),e(),i(3,"div",0)(4,"div",1)(5,"div",2)(6,"div",3)(7,"div",4),ae(8,Di,6,6,"div",22,Ii),e()()(),i(10,"div",5)(11,"div")(12,"input",6,7),_("change",function(Y){return l.onFileSelected(Y)}),e(),i(14,"button",8),_("click",function(){h(f);let Y=xe(13);return v(Y.click())}),U(),i(15,"svg",9),c(16,"path",10),e()()(),Z(),i(17,"div",11)(18,"div",12)(19,"form",13)(20,"input",14),_("ngModelChange",function(Y){return l.msj.content=Y}),e()()()(),i(21,"div",15)(22,"button",16),_("click",function(){return l.sendMessage()}),i(23,"span"),U(),i(24,"svg",17),c(25,"path",18),e()()()()()()()}m&2&&(T(0,l.loading?0:-1),o(2),S("Venta N\xB0 ",l.item.number,""),o(6),oe(l.messages),o(12),d("ngModel",l.msj.content))},dependencies:[F,z,N,k,V,P,O,D,W,se]});let t=r;return t})();var Oi=[{path:"",redirectTo:"index",pathMatch:"full"},{path:"index",component:Le,canActivate:[Q],data:{access:["sale.index"]}},{path:"create",component:Fe,canActivate:[Q],data:{access:["sale.create"]}},{path:"edit/:id",component:Re,canActivate:[Q],data:{access:["sale.edit"]}},{path:"detail/:id",component:He,canActivate:[Q],data:{access:["sale.detail"]}},{path:"message/:id",component:qe,canActivate:[Q],data:{access:["sale.message"]}}],Be=(()=>{let r=class r{};r.\u0275fac=function(m){return new(m||r)},r.\u0275mod=ne({type:r}),r.\u0275inj=ie({imports:[_e.forChild(Oi),_e]});let t=r;return t})();var Fn=(()=>{let r=class r{};r.\u0275fac=function(m){return new(m||r)},r.\u0275mod=ne({type:r}),r.\u0275inj=ie({imports:[ye,Be,Ie,we,ke,Ve,Te,Ne,Oe]});let t=r;return t})();export{Fn as SaleModule};
